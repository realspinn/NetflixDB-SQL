/* 🧩 User & Subscription Analysis
List all users who signed up in the same month and year as their first subscription start date.

Which users are on the most expensive plan currently active? List their full name, plan name, and price.

Find users who have had more than one subscription (renewed).

Which users have active subscriptions that will expire in the next 10 days?

Which plan has the highest average subscription duration (in days)?

Find users who have never watched any movies.

List users who watched at least 5 movies in a single day.

Who are the top 5 users with the longest total watch time?

Which users have watched movies from more than 5 different genres?

Find users who have been subscribed to Netflix for over a year continuously (no gap between end_date and next start_date).

🍿 Movies & Watch Behavior
List the top 10 most watched movies along with their genres and total watch count.

Find the most watched genre in each year.

Which movies have never been watched?

For each movie, what is the average watch duration as a percentage of 120 minutes (standard movie length)?

Which genre has the highest average movie rating?

Which 5 movies have the highest average watch time per user?

What is the total watch time per genre this year?

Which user watched the highest-rated movie of all time, and when?

Which users watched more than 3 movies from the same genre in a day?

What are the average watch times per user per month for the last 6 months?

🏗️ Window Functions & Advanced Joins
Rank users by total watch time using a window function (partitioned by plan).

Find the most recent movie watched by each user.

Show each user's first and last watched movie title.

Which user has the longest gap between any two watch events?

Show the cumulative watch time per user, ordered by date.

For each plan, how many users upgraded or downgraded from/to it (based on previous subscriptions)?

Using a window function, find users who consistently watched something every day for 7 consecutive days.

🔍 Subqueries, Aggregates, and CTEs
Find all users who have watched only top-rated movies (above 4.5 rating).

Using a CTE, find users whose total watch time is below the average for their plan.

For each month, find the most-watched movie and its total watch count. */